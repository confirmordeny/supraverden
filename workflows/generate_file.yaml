# This workflow automates the process of generating a Markdown table
# from a data file. It runs on every push to the main branch.

name: Generate UN Bodies Table

on:
  # Triggers the workflow on push events for the "main" branch
  push:
    branches:
      - main
  
  # Allows this workflow to be ran manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1. Checks out the repository under $GITHUB_WORKSPACE, so the job can access it
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2. Sets up Python 3.x environment
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      # 3. Runs the Python script to generate the Markdown file
      - name: Run script to generate Markdown table
        run: |
          # The script takes the input file path and the desired output file path
          python scripts/generate_table.py un_bodies_list.txt UN_BODIES.md

      # 4. Commits the generated file back to the repository if there are any changes
      - name: Commit and push if changed
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "docs: Auto-update UN bodies table"
          # Specify the file to check for changes and commit
          file_pattern: UN_BODIES.md

